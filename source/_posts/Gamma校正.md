---
title: Gamma校正
categories: 渲染
---

一、Gamma校正的由来
- 人眼对亮度感受的非线性， 类似于一个pow曲线，对暗部的敏感度强一些。图像中的空间有限，没必要在图像中给亮部太多空间。
- CRT显示器，阴极管发射出来的光子的亮度非线性。

Gamma空间的由来。 最初CRT显示器的问题，输出的亮度和电压并不是线性关系，近似于2.2次幂的关系，看到的亮度要比实际存储的亮度要低。需要在显示器显示前，将亮度做调整，Inversegamma也就是变为自身的1/2.2次幂，就能补偿显示器造成的亮度下降了。
人眼对暗部比较敏感，早起的图片存储的色彩有限。所以提高暗部的区域，做了一次Gamma校正。也就是pow(1/2.2)的处理，也就是现在美术作图时的常用空间sRGB颜色空间。
sRGB空间的做出来图直接在显示器中显示，正好可以显示出原本的颜色。
因为在sRGB空间的图片 存储的是亮度是观察到的亮度的1/2.2幂。即美术制作的亮度值为0.5的图，经过显示器显示后亮度变为0.218。进行光照运算，将亮度变为原来的2倍。如果不做Gamma校正，0.5 *2 =1，显示的亮度为1.变为原来的4倍。这与我们想要的不一样。对贴图做Gamma校正，2.2，将亮度变为线性空间的值0.218，乘2得0.436，这时候不能直接输出，需要再做一次Gamma校正0.45，得到0.688，最后经过显示器得到0.439，就是我们想要的结果。
二、如何进行Gamma校正
- encoding gamma、display gamma
- 非线性->线性->非线性->Display

二、渲染中的运算
- 图片是在sRGB标准下做的。
- 一个贴图颜色亮度是原来的两倍，在光照着色中对颜色乘以2即可。但实际上并不是这样。虽然光照是线性的，各个不同的光照相加即可。但是贴图并不在线性空间。用没有gamma校正的显示器显示的时候，结果会比预想中的要暗。
- 如果不做gamma校正，用贴图的颜色做运算，比如乘以2，然后在显示器中显示（Display Gamma）。对非线性的输入进行运算，由显示器转换到线性空间。介绍运算的结果为啥是错的。
- mipmap 1.0 + 0.0  0.5
- 光照 Nvida skin


### 参考
1. https://zhuanlan.zhihu.com/p/36581276
2. https://en.wikipedia.org/wiki/Gamma_correction
3. https://www.zhihu.com/question/27467127
4. https://blog.csdn.net/candycat1992/article/details/46228771
5. https://developer.nvidia.com/gpugems/GPUGems3/gpugems3_ch24.html